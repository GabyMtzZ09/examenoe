<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Interactivo - Orientaci√≥n Educativa</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyDDxWh8p_yauwGWMT2w5v6rGmkvHMqtGXk",
            authDomain: "examen-oe.firebaseapp.com",
            projectId: "examen-oe",
            storageBucket: "examen-oe.firebasestorage.app",
            messagingSenderId: "679560151071",
            appId: "1:679560151071:web:d4ec4bc883472001c6952a"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        window.saveResults = async function(name, correctAnswers, wrongAnswers) {
            try {
                await addDoc(collection(db, "resultados"), {
                    nombre: name,
                    aciertos: correctAnswers,
                    errores: wrongAnswers,
                    fecha: new Date().toISOString()
                });
                alert("Resultados guardados correctamente.");
            } catch (e) {
                console.error("Error al guardar: ", e);
            }
        };
    </script>
    <style>
        body {
            font-family: 'Arial Black', sans-serif;
            background: #00A86B;
            color: #fff;
            text-align: center;
            padding: 20px;
        }
        .container {
            background: white;
            color: #333;
            max-width: 800px;
            margin: auto;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        h1 {
            font-size: 28px;
            color: #FFD700;
            text-transform: uppercase;
            margin-bottom: 15px;
        }
        .form-container {
            margin-bottom: 20px;
        }
        .form-container input {
            padding: 10px;
            width: 80%;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .form-container button {
            padding: 10px 20px;
            font-size: 18px;
            background: #FFD700;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        .form-container button:hover {
            background: #FFAA00;
        }
    </style>
</head>
<body>
    <div class="container" id="form-container">
        <h1>üöÄ Examen Interactivo</h1>
        <div class="form-container">
            <input type="text" id="student-name" placeholder="Ingresa tu nombre">
            <button onclick="startExam()">Comenzar Examen</button>
        </div>
    </div>
    <div class="container" id="exam-container" style="display: none;">
        <div class="timer">‚è≥ Tiempo: <span id="time">60</span> segundos</div>
        <div class="score">‚úÖ Aciertos: <span id="correct">0</span> | ‚ùå Errores: <span id="wrong">0</span></div>
        <div class="icon" id="icono"></div>
        <div class="question" id="question">Cargando pregunta...</div>
        <div class="options" id="options"></div>
        <div class="feedback" id="feedback"></div>
    </div>

    <script>
        let studentName = "";
        const questions = [
            { question: "¬øCu√°l es el principal rol de un orientador educativo?", options: ["Ense√±ar matem√°ticas", "Brindar apoyo emocional y acad√©mico", "Administrar la escuela", "Revisar tareas"], answer: 1, explanation: "El orientador educativo apoya a los estudiantes en su desarrollo acad√©mico y emocional.", icon: "fa-user-graduate" },
            { question: "¬øQu√© herramienta es √∫til para evaluar las necesidades de un estudiante?", options: ["Entrevistas", "Redes sociales", "Juegos de azar", "Publicidad"], answer: 0, explanation: "Las entrevistas permiten conocer las necesidades individuales de los estudiantes.", icon: "fa-comments" }
        ];
        
        let currentQuestion = 0;
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let timeLeft = 60;
        
        function startExam() {
            studentName = document.getElementById("student-name").value;
            if (!studentName) {
                alert("Por favor ingresa tu nombre.");
                return;
            }
            document.getElementById("form-container").style.display = "none";
            document.getElementById("exam-container").style.display = "block";
            loadQuestion();
            startTimer();
        }
        
        function loadQuestion() {
            if (currentQuestion >= questions.length) {
                document.querySelector('#exam-container').innerHTML = `<h2>üéâ Examen terminado</h2><p>‚úÖ Aciertos: ${correctAnswers}</p><p>‚ùå Errores: ${wrongAnswers}</p>`;
                saveResults(studentName, correctAnswers, wrongAnswers);
                return;
            }
            const q = questions[currentQuestion];
            document.getElementById('question').textContent = q.question;
            document.getElementById('icono').innerHTML = `<i class="fas ${q.icon}"></i>`;
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            q.options.forEach((opt, index) => {
                const button = document.createElement('button');
                button.textContent = opt;
                button.onclick = () => checkAnswer(index);
                optionsDiv.appendChild(button);
            });
            document.getElementById('feedback').textContent = '';
        }
        
        function checkAnswer(selected) {
            const q = questions[currentQuestion];
            if (selected === q.answer) {
                correctAnswers++;
                document.getElementById('feedback').textContent = "üéâ ¬°Correcto! " + q.explanation;
            } else {
                wrongAnswers++;
                document.getElementById('feedback').textContent = "‚ùå Incorrecto. La respuesta correcta es: " + q.options[q.answer];
            }
            document.getElementById('correct').textContent = correctAnswers;
            document.getElementById('wrong').textContent = wrongAnswers;
            currentQuestion++;
            setTimeout(loadQuestion, 2000);
        }
        
        function startTimer() {
            const timerInterval = setInterval(() => {
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    document.querySelector('#exam-container').innerHTML = `<h2>‚è≥ Tiempo agotado</h2>`;
                    saveResults(studentName, correctAnswers, wrongAnswers);
                    return;
                }
                document.getElementById('time').textContent = timeLeft;
                timeLeft--;
            }, 1000);
        }
    </script>
</body>
</html>
